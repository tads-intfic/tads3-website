<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta property="og:type" content="website">
    <link rel="icon" href="/assets/images/tads-favicon.png" type="image/png">
    <link rel="stylesheet" type="text/css"
                           href="/assets/css/styles.css">
    <title>docs-adv3-doc-libref-object-commandtranscript-html</title>
    <meta property="og:title" content=
    "docs-adv3-doc-libref-object-commandtranscript-html">
    <meta name="description" content="">
    <meta property="og:description" content="">
</head>
<header><div class="header-search">
    <form class="header-search-form" action="/search" method="get">
      <input type="text" id="search-box" name="query">
      <input type="submit" value="search">
    </form>
  </div>  </header>
<body>
<main id="content">
<p><span class="title">CommandTranscript</span><span class="type">class</span></p>

<p><a href="../file/report.t.html">report.t</a>[<a href="../source/report.t.html#606">606</a>]</p>

<p><a href="#_SuperClassTree_">Superclass<br />
Tree</a></p>

<p><a href="#_SubClassTree_">Subclass<br />
Tree</a></p>

<p><a href="#_ObjectSummary_">Global<br />
Objects</a></p>

<p><a href="#_PropSummary_">Property<br />
Summary</a></p>

<p><a href="#_MethodSummary_">Method<br />
Summary</a></p>

<p><a href="#_Properties_">Property<br />
Details</a></p>

<p><a href="#_Methods_">Method<br />
Details</a></p>

<p>Command Transcript. This is a “semantic transcript” of the results of a
command. This provides a list of CommandReport objects describing the
results of the command.</p>

<p><code class="language-plaintext highlighter-rouge">class </code><strong><code class="language-plaintext highlighter-rouge">CommandTranscript</code></strong><code class="language-plaintext highlighter-rouge"> :   </code><a href="../object/OutputFilter.html"><code class="language-plaintext highlighter-rouge">OutputFilter</code></a></p>

<p><span id="_SuperClassTree_"></span></p>

<p><span class="hdln">Superclass Tree</span>   (in declaration order)</p>

<p><strong><code class="language-plaintext highlighter-rouge">CommandTranscript</code></strong><br />
<a href="../object/OutputFilter.html"><code class="language-plaintext highlighter-rouge">OutputFilter</code></a><br />
`                 object`<br />
<span id="_SubClassTree_"></span></p>

<p><span class="hdln">Subclass Tree</span>  </p>

<p><em>(none)</em> <span id="_ObjectSummary_"></span></p>

<p><span class="hdln">Global Objects</span>  </p>

<p><em>(none)</em> <span id="_PropSummary_"></span></p>

<p><span class="hdln">Summary of Properties</span>  </p>

<p><a href="#isActive"><code class="language-plaintext highlighter-rouge">isActive</code></a> <a href="#isFailure"><code class="language-plaintext highlighter-rouge">isFailure</code></a> <a href="#iter_"><code class="language-plaintext highlighter-rouge">iter_</code></a> <a href="#reports_"><code class="language-plaintext highlighter-rouge">reports_</code></a> <a href="#transforms_"><code class="language-plaintext highlighter-rouge">transforms_</code></a></p>

<p><span id="_MethodSummary_"></span></p>

<p><span class="hdln">Summary of Methods</span>  </p>

<p><a href="#actionFailed"><code class="language-plaintext highlighter-rouge">actionFailed</code></a> <a href="#activate"><code class="language-plaintext highlighter-rouge">activate</code></a> <a href="#addCommandSep"><code class="language-plaintext highlighter-rouge">addCommandSep</code></a> <a href="#addMarker"><code class="language-plaintext highlighter-rouge">addMarker</code></a> <a href="#addReport"><code class="language-plaintext highlighter-rouge">addReport</code></a> <a href="#announceAmbigActionObject"><code class="language-plaintext highlighter-rouge">announceAmbigActionObject</code></a> <a href="#announceDefaultObject"><code class="language-plaintext highlighter-rouge">announceDefaultObject</code></a> <a href="#announceImplicit"><code class="language-plaintext highlighter-rouge">announceImplicit</code></a> <a href="#announceMultiActionObject"><code class="language-plaintext highlighter-rouge">announceMultiActionObject</code></a> <a href="#announceRemappedAction"><code class="language-plaintext highlighter-rouge">announceRemappedAction</code></a> <a href="#applyTransforms"><code class="language-plaintext highlighter-rouge">applyTransforms</code></a> <a href="#canShowReport"><code class="language-plaintext highlighter-rouge">canShowReport</code></a> <a href="#clearReports"><code class="language-plaintext highlighter-rouge">clearReports</code></a> <a href="#construct"><code class="language-plaintext highlighter-rouge">construct</code></a> <a href="#currentActionHasReport"><code class="language-plaintext highlighter-rouge">currentActionHasReport</code></a> <a href="#deactivate"><code class="language-plaintext highlighter-rouge">deactivate</code></a> <a href="#deleteLastReport"><code class="language-plaintext highlighter-rouge">deleteLastReport</code></a> <a href="#deleteRange"><code class="language-plaintext highlighter-rouge">deleteRange</code></a> <a href="#endDescription"><code class="language-plaintext highlighter-rouge">endDescription</code></a> <a href="#filterText"><code class="language-plaintext highlighter-rouge">filterText</code></a> <a href="#findCurrentActionReport"><code class="language-plaintext highlighter-rouge">findCurrentActionReport</code></a> <a href="#flushForInput"><code class="language-plaintext highlighter-rouge">flushForInput</code></a> <a href="#forEachReport"><code class="language-plaintext highlighter-rouge">forEachReport</code></a> <a href="#getLastReport"><code class="language-plaintext highlighter-rouge">getLastReport</code></a> <a href="#moveRangeAppend"><code class="language-plaintext highlighter-rouge">moveRangeAppend</code></a> <a href="#newIter"><code class="language-plaintext highlighter-rouge">newIter</code></a> <a href="#noteFailure"><code class="language-plaintext highlighter-rouge">noteFailure</code></a> <a href="#showReports"><code class="language-plaintext highlighter-rouge">showReports</code></a> <a href="#summarizeAction"><code class="language-plaintext highlighter-rouge">summarizeAction</code></a></p>

<p><span id="_Properties_"></span></p>

<p><span class="hdln">Properties</span>  </p>

<p><span id="isActive"></span></p>

<p><code class="language-plaintext highlighter-rouge">isActive</code></p>

<p><a href="../file/report.t.html">report.t</a>[<a href="../source/report.t.html#648">648</a>]</p>

<p>flag: I’m active; when this is nil, we’ll pass text through our filter
routine unchanged</p>

<p><span id="isFailure"></span></p>

<p><code class="language-plaintext highlighter-rouge">isFailure</code></p>

<p><a href="../file/report.t.html">report.t</a>[<a href="../source/report.t.html#617">617</a>]</p>

<p>flag: the command has failed (i.e., at least one failure report has been
generated)</p>

<p><span id="iter_"></span></p>

<p><code class="language-plaintext highlighter-rouge">iter_</code></p>

<p><a href="../file/report.t.html">report.t</a>[<a href="../source/report.t.html#1235">1235</a>]</p>

<p>iteration number - for an iterated top-level command, this helps us keep
the results for a particular iteration grouped together</p>

<p><span id="reports_"></span></p>

<p><code class="language-plaintext highlighter-rouge">reports_</code></p>

<p><a href="../file/report.t.html">report.t</a>[<a href="../source/report.t.html#1238">1238</a>]</p>

<p>our vector of reports</p>

<p><span id="transforms_"></span></p>

<p><code class="language-plaintext highlighter-rouge">transforms_</code></p>

<p><a href="../file/report.t.html">report.t</a>[<a href="../source/report.t.html#1241">1241</a>]</p>

<p>our list of transformations</p>

<p><span id="_Methods_"></span></p>

<p><span class="hdln">Methods</span>  </p>

<p><span id="actionFailed"></span></p>

<p><code class="language-plaintext highlighter-rouge">actionFailed (action)</code></p>

<p><a href="../file/report.t.html">report.t</a>[<a href="../source/report.t.html#634">634</a>]</p>

<p>Did the given action fail? This scans the transcript to determine if
there are any failure messages associated with the given action.</p>

<p><span id="activate"></span></p>

<p><code class="language-plaintext highlighter-rouge">activate ( )</code></p>

<p><a href="../file/report.t.html">report.t</a>[<a href="../source/report.t.html#842">842</a>]</p>

<p>activate - set up to capture output</p>

<p><span id="addCommandSep"></span></p>

<p><code class="language-plaintext highlighter-rouge">addCommandSep ( )</code></p>

<p><a href="../file/report.t.html">report.t</a>[<a href="../source/report.t.html#1148">1148</a>]</p>

<p>Add a command separator.</p>

<p><span id="addMarker"></span></p>

<p><code class="language-plaintext highlighter-rouge">addMarker ( )</code></p>

<p><a href="../file/report.t.html">report.t</a>[<a href="../source/report.t.html#1005">1005</a>]</p>

<p>Add a marker report. This adds a marker to the report stream, and
returns the marker object. The marker doesn’t show any message in the
final display, but callers can use a pair of markers to identify a range
of reports for later reordering or removal.</p>

<p><span id="addReport"></span></p>

<p><code class="language-plaintext highlighter-rouge">addReport (report)</code></p>

<p><a href="../file/report.t.html">report.t</a>[<a href="../source/report.t.html#934">934</a>]</p>

<p>Add a report.</p>

<p><span id="announceAmbigActionObject"></span></p>

<p><code class="language-plaintext highlighter-rouge">announceAmbigActionObject (obj, whichObj)</code></p>

<p><a href="../file/report.t.html">report.t</a>[<a href="../source/report.t.html#1129">1129</a>]</p>

<p>Announce an object that was resolved with slight ambiguity.</p>

<p><span id="announceDefaultObject"></span></p>

<p><code class="language-plaintext highlighter-rouge">announceDefaultObject (obj, whichObj, action, allResolved)</code></p>

<p><a href="../file/report.t.html">report.t</a>[<a href="../source/report.t.html#1138">1138</a>]</p>

<p>Announce a default object.</p>

<p><span id="announceImplicit"></span></p>

<p><code class="language-plaintext highlighter-rouge">announceImplicit (action, msgProp)</code></p>

<p><a href="../file/report.t.html">report.t</a>[<a href="../source/report.t.html#1080">1080</a>]</p>

<p>Announce that the action is implicit</p>

<p><span id="announceMultiActionObject"></span></p>

<p><code class="language-plaintext highlighter-rouge">announceMultiActionObject (preCalcMsg, obj, whichObj)</code></p>

<p><a href="../file/report.t.html">report.t</a>[<a href="../source/report.t.html#1119">1119</a>]</p>

<p>Announce one of a set of objects to a multi-object action. We’ll record
this announcement for display with our report list.</p>

<p><span id="announceRemappedAction"></span></p>

<p><code class="language-plaintext highlighter-rouge">announceRemappedAction ( )</code></p>

<p><a href="../file/report.t.html">report.t</a>[<a href="../source/report.t.html#1109">1109</a>]</p>

<p>Announce a remapped action</p>

<p><span id="applyTransforms"></span></p>

<p><code class="language-plaintext highlighter-rouge">applyTransforms ( )</code></p>

<p><a href="../file/report.t.html">report.t</a>[<a href="../source/report.t.html#1203">1203</a>]</p>

<p>apply transformations</p>

<p><span id="canShowReport"></span></p>

<p><code class="language-plaintext highlighter-rouge">canShowReport (report)</code></p>

<p><a href="../file/report.t.html">report.t</a>[<a href="../source/report.t.html#1169">1169</a>]</p>

<p>Can we show a given report? By default, we always return true, but
subclasses might want to override this to suppress certain types of
reports.</p>

<p><span id="clearReports"></span></p>

<p><code class="language-plaintext highlighter-rouge">clearReports ( )</code></p>

<p><a href="../file/report.t.html">report.t</a>[<a href="../source/report.t.html#1157">1157</a>]</p>

<p>clear our reports</p>

<p><span id="construct"></span></p>

<p><code class="language-plaintext highlighter-rouge">construct ( )</code></p>

<p><a href="../file/report.t.html">report.t</a>[<a href="../source/report.t.html#607">607</a>]</p>

<p><em>no description available</em></p>

<p><span id="currentActionHasReport"></span></p>

<p><code class="language-plaintext highlighter-rouge">currentActionHasReport (func)</code></p>

<p><a href="../file/report.t.html">report.t</a>[<a href="../source/report.t.html#1214">1214</a>]</p>

<p>check to see if the current action has a report matching the given
criteria</p>

<p><span id="deactivate"></span></p>

<p><code class="language-plaintext highlighter-rouge">deactivate ( )</code></p>

<p><a href="../file/report.t.html">report.t</a>[<a href="../source/report.t.html#849">849</a>]</p>

<p>deactivate - stop capturing output</p>

<p><span id="deleteLastReport"></span></p>

<p><code class="language-plaintext highlighter-rouge">deleteLastReport ( )</code></p>

<p><a href="../file/report.t.html">report.t</a>[<a href="../source/report.t.html#991">991</a>]</p>

<p>delete the last report added</p>

<p><span id="deleteRange"></span></p>

<p><code class="language-plaintext highlighter-rouge">deleteRange (marker1, marker2)</code></p>

<p><a href="../file/report.t.html">report.t</a>[<a href="../source/report.t.html#1018">1018</a>]</p>

<p>delete the reports between two markers</p>

<p><span id="endDescription"></span></p>

<p><code class="language-plaintext highlighter-rouge">endDescription ( )</code></p>

<p><a href="../file/report.t.html">report.t</a>[<a href="../source/report.t.html#1071">1071</a>]</p>

<p>End the description section of the report. This adds a marker report
that indicates that anything following (and part of the same action) is
no longer part of the description; this can be important when we apply
the default description suppression transformation, because it tells us
not to consider the non-descriptive messages following this marker when,
for example, suppressing default descriptive messages.</p>

<p><span id="filterText"></span></p>

<p><code class="language-plaintext highlighter-rouge">filterText (ostr, txt)</code><span class="rem">OVERRIDDEN</span></p>

<p><a href="../file/report.t.html">report.t</a>[<a href="../source/report.t.html#1177">1177</a>]</p>

<p>Filter text. If we’re active, we’ll turn the text into a command report
and add it to our report list, blocking the text from reaching the
underlying stream; otherwise, we’ll pass it through unchanged.</p>

<p><span id="findCurrentActionReport"></span></p>

<p><code class="language-plaintext highlighter-rouge">findCurrentActionReport (func)</code></p>

<p><a href="../file/report.t.html">report.t</a>[<a href="../source/report.t.html#1221">1221</a>]</p>

<p>find a report in the current action that matches the given criteria</p>

<p><span id="flushForInput"></span></p>

<p><code class="language-plaintext highlighter-rouge">flushForInput ( )</code></p>

<p><a href="../file/report.t.html">report.t</a>[<a href="../source/report.t.html#871">871</a>]</p>

<p>Flush the transcript in preparation for reading input. This shows all
pending reports, clears the backlog of reports (so that we don’t show
them again in the future), and deactivates the transcript’s capture
feature so that subsequent output goes directly to the output stream.</p>

<p>We return the former activation status - that is, we return true if the
transcript was activated before the call, nil if not.</p>

<p><span id="forEachReport"></span></p>

<p><code class="language-plaintext highlighter-rouge">forEachReport (func)</code></p>

<p><a href="../file/report.t.html">report.t</a>[<a href="../source/report.t.html#1060">1060</a>]</p>

<p>Perform a callback on all of the reports in the transcript. We’ll invoke
the given callback function func(rpt) once for each report, with the
report object as the parameter.</p>

<p><span id="getLastReport"></span></p>

<p><code class="language-plaintext highlighter-rouge">getLastReport ( )</code></p>

<p><a href="../file/report.t.html">report.t</a>[<a href="../source/report.t.html#984">984</a>]</p>

<p>get the last report added</p>

<p><span id="moveRangeAppend"></span></p>

<p><code class="language-plaintext highlighter-rouge">moveRangeAppend (marker1, marker2)</code></p>

<p><a href="../file/report.t.html">report.t</a>[<a href="../source/report.t.html#1035">1035</a>]</p>

<p>Pull out the reports between two markers, and reinsert them at the end
of the transcript.</p>

<p><span id="newIter"></span></p>

<p><code class="language-plaintext highlighter-rouge">newIter ( )</code></p>

<p><a href="../file/report.t.html">report.t</a>[<a href="../source/report.t.html#859">859</a>]</p>

<p>Count an iteration. An Action should call this once per iteration if
it’s a top-level (non-nested) command.</p>

<p><span id="noteFailure"></span></p>

<p><code class="language-plaintext highlighter-rouge">noteFailure ( )</code></p>

<p><a href="../file/report.t.html">report.t</a>[<a href="../source/report.t.html#623">623</a>]</p>

<p>Note that the current action has failed. This is equivalent to adding a
reportFailure() message to the transcript.</p>

<p><span id="showReports"></span></p>

<p><code class="language-plaintext highlighter-rouge">showReports (deact)</code></p>

<p><a href="../file/report.t.html">report.t</a>[<a href="../source/report.t.html#887">887</a>]</p>

<p>Show our reports. Returns true if the transcript was previously active,
nil if not.</p>

<p><span id="summarizeAction"></span></p>

<p><code class="language-plaintext highlighter-rouge">summarizeAction (cond, report)</code></p>

<p><a href="../file/report.t.html">report.t</a>[<a href="../source/report.t.html#693">693</a>]</p>

<p>Summarize the current action’s reports. This allows a caller to turn a
series of iterated reports into a single report for the entire action.
For example, we could change something like this:</p>

<p>gold coin: Bob accepts the gold coin.<br />
gold coin: Bob accepts the gold coin.<br />
gold coin: Bob accepts the gold coin.</p>

<p>into this:</p>

<p>Bob accepts the three gold coins.</p>

<p>This function runs through the reports for the current action,
submitting each one to the ‘cond’ callback to see if it’s of interest to
the summary. For each consecutive run of two or more reports that can be
summarized, we’ll remove the reports that ‘cond’ accepted, and we’ll
remove the multiple-object announcement reports associated with them,
and we’ll insert a new report with the message returned by the ‘report’
callback.</p>

<p>‘cond’ is called as cond(x), where ‘x’ is a report object. This callback
returns true if the report can be summarized for the caller’s purposes,
nil if not.</p>

<p>‘report’ is called as report(vec), where ‘vec’ is a Vector consisting of
all of the consecutive report objects that we’re now summarizing. This
function returns a string giving the message to use in place of the
reports we’re removing. This should be a summary message, standing in
for the set of individual reports we’re removing.</p>

<p>There’s an important subtlety to note. If the messages you’re
summarizing are conversational (that is, if they’re generated by
TopicEntry responses), you should take care to generate the full
replacement text in the ‘report’ part, rather than doing so in separate
code that you run after summarizeAction() returns. This is important
because it ensures that the Conversation Manager knows that your
replacement message is part of the same conversation. If you wait until
after summarizeAction() returns to generate more response text, the
conversation manager won’t realize that the additional text is part of
the same conversation.</p>

<p>TADS 3 Library Manual<br />
Generated on 5/16/2013 from TADS version 3.1.3</p>


</main>
<footer>
    <p>This is an unofficial informational website to aggregate TADS 3 information and does not claim authorship over, or any rights to, TADS 3 itself. All resources copyright their credited owners. TADS itself is <a href="https://www.tads.org/copyright.htm">Copyright ©2001-2013 Michael J. Roberts</a>.</p>
    <p><a href="/">Back to Homepage</a></p>
</footer>
</body>
</html>